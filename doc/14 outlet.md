# Outlet类

## 1. 概述
控制单个出口的舵机动作，引导物品至指定分拣通道，并支持直径范围配置。

## 2. 公共接口
- `Outlet()` - 构造函数
- `void initialize(int servoPin, int minD = 0, int maxD = 0)` - 初始化舵机、引脚和直径范围（minD和maxD定义该出口可分拣的直径范围，单位为毫米）
- `void preOpen(bool state)` - 设置出口预开状态（true：准备打开出口，false：准备关闭出口）
- `void execute()` - 执行出口控制动作（根据preOpen设置的状态驱动舵机到相应位置）
- `int getMinDiameter() const` - 获取该出口可分拣的最小直径值（单位为毫米）
- `int getMaxDiameter() const` - 获取该出口可分拣的最大直径值（单位为毫米）

**注**：直径范围参数以毫米为单位，与Sorter类中使用的转换后直径值保持一致。

## 3. 测试方法

### 3.1 轮巡降落测试模式

该测试模式用于依次测试所有出口的开关动作，确保每个出口的舵机工作正常。

**测试流程：**

1. **出口打开**：每5秒钟，打开一个出口（出口下降）
2. **保持状态**：保持出口打开状态5秒钟
3. **出口关闭**：关闭当前出口（出口上升）
4. **等待间隔**：等待5秒钟
5. **下一个出口**：打开下一个出口
6. **循环测试**：重复上述步骤，依次测试所有出口
7. **无限循环**：测试过程会一直循环下去，直到切换到其他模式

**时间安排：**

- 舵机打开时间：约0.5秒（机械动作时间，软件无法控制）
- 出口打开保持时间：4.5秒
- 舵机关闭时间：约0.5秒（机械动作时间，软件无法控制）
- 出口关闭保持时间：1.5秒
- 单个出口测试周期：6秒（0.5 + 4.5 + 0.5 + 1.5）

**测试目的：**

- 验证每个出口的舵机是否能够正常工作
- 检查出口的打开和关闭动作是否顺畅
- 确认出口的机械结构是否正常
- 排查出口可能存在的故障

**注意事项：**

- 测试过程中，所有出口会依次被测试
- 每次只有一个出口处于打开状态
- 测试模式会自动循环，无需手动干预
- 如需停止测试，请切换到其他模式

### 3.2 轮巡上升测试模式

该测试模式与轮巡降落测试模式正好相反，用于测试出口的常态闭合状态。

**测试流程：**

1. **出口关闭**：每5秒钟，关闭一个出口（出口上升）
2. **保持状态**：保持出口关闭状态5秒钟
3. **出口打开**：打开当前出口（出口下降）
4. **等待间隔**：等待5秒钟
5. **下一个出口**：关闭下一个出口
6. **循环测试**：重复上述步骤，依次测试所有出口
7. **无限循环**：测试过程会一直循环下去，直到切换到其他模式

**时间安排：**

- 舵机关闭时间：约0.5秒（机械动作时间，软件无法控制）
- 出口关闭保持时间：4.5秒
- 舵机打开时间：约0.5秒（机械动作时间，软件无法控制）
- 出口打开保持时间：1.5秒
- 单个出口测试周期：7秒（0.5 + 4.5 + 0.5 + 1.5）

**测试目的：**

- 验证每个出口的舵机是否能够正常工作
- 检查出口的打开和关闭动作是否顺畅
- 确认出口的机械结构是否正常
- 排查出口可能存在的故障

**注意事项：**

- 测试过程中，所有出口会依次被测试
- 每次只有一个出口处于关闭状态
- 测试模式会自动循环，无需手动干预
- 如需停止测试，请切换到其他模式

#### 3.1.1 OLED显示功能

在轮巡降落测试模式下，OLED屏幕会显示一个直观的图形化界面，展示所有出口的状态。

**显示格式：**

```
Outlet Test
-----------
1 2   4 5 6 7 8
      3         
Open: 3
```

**显示说明：**

- **第一排**：显示出口编号（1-8），横排显示，打开的出口位置显示空格
- **第二排**：显示打开的出口数字，其他位置显示空格
  - 数字：表示打开的出口（下降状态）
  - 空格：表示关闭的出口（上升状态）
- **底部**：显示当前打开的出口编号（Open: X）

**更新时机：**

- 模式启动时：显示初始状态（所有出口关闭）
- 每5秒切换状态时：更新显示，反映当前打开的出口

**显示目的：**

- 提供直观的视觉反馈，让用户清楚地看到哪些出口处于打开状态
- 便于观察出口测试的进展
- 帮助识别可能存在问题的出口

#### 3.1.2 OLED显示功能

在轮巡上升测试模式下，OLED屏幕会显示一个直观的图形化界面，展示所有出口的状态。

**显示格式：**

```
Outlet Test
-----------
  3         
1 2 4 5 6 7 8
Close: 3
```

**显示说明：**

- **第一行**：显示关闭的出口编号（只有一个），前面用空格表示打开的出口
- **第二行**：显示打开的出口数字（其他所有出口），关闭的出口位置用空格表示
  - 数字：表示打开的出口（下降状态）
  - 空格：表示关闭的出口（上升状态）
- **底部**：显示当前关闭的出口编号（Close: X）

**更新时机：**

- 模式启动时：显示初始状态
- 每5秒切换状态时：更新显示

**显示目的：**

- 提供直观的视觉反馈，让用户清楚地看到当前子模式
- 便于观察出口测试的进展
- 帮助识别可能存在问题的出口