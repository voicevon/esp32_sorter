# ESP32 Sorter 操作指南

本指南说明如何操作 ESP32 Sorter，包括模式切换、显示信息和 HMI 使用。

---

## 1. 系统模式

系统使用 **主按钮 (Master Button)** 在有效模式之间循环切换。

### 1.1 MODE_NORMAL (生产模式)
标准分拣工作模式。
-   **子模式 0 (统计)**：显示速度（根/小时）、识别总数、托架计数。
-   **子模式 1 (实时数据)**：显示最新测量的直径。

### 1.2 MODE_DIAGNOSE_ENCODER
检查编码器的工具。
-   **子模式 0 (位置)**：显示当前逻辑位置 (0-199)。仅在变化时更新。
-   **子模式 1 (相位)**：调试相位转换。

### 1.3 MODE_DIAGNOSE_SCANNER
检查激光扫描仪的工具。
-   实时显示原始传感器数据。
-   测试扫描仪对齐和读数稳定性。

### 1.4 MODE_DIAGNOSE_OUTLET
测试舵机的工具。
-   **子模式 0 (循环降落)**：逐个打开出口（顺序执行）。
-   **子模式 1 (循环上升)**：逐个关闭出口。

### 1.5 MODE_TEST_RELOADER
-   每5秒切换一次上料器舵机（运行15秒，停止5秒循环）。

### 1.6 MODE_VERSION_INFO
-   显示固件版本、作者和联系信息。

---

## 2. HMI 与控制

### 2.1 按钮
-   **主按钮 (Master Button / GPIO 4)**:
    -   *短按*：切换到 **下一个主模式**。
    -   *循环*：版本信息 -> 正常模式。
-   **从按钮 (Slave Button / GPIO 5)**:
    -   *功能*：切换当前主模式内的 **子模式**（例如，在正常模式下切换统计/实时数据）。

### 2.2 OLED 显示器
SSD1306 OLED 提供上下文感知的反馈。
-   **刷新策略**：为防止阻塞控制循环，显示器仅在数据变化时或以固定的安全间隔更新（不在中断内更新）。

### 2.3 LED 指示灯
-   LED 主要用于指示特定出口状态或系统心跳，尽管在较新的固件版本中，其用途已简化，更多依赖 OLED 显示。
